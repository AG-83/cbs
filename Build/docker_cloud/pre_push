#!/bin/bash

# Get a new build number for current version
source $REPO_ROOT/Build/docker_cloud/new_build_num

# Short commit sha
SHORT_COMMIT=$(echo $SOURCE_COMMIT | cut -c -7)

# New image name, repo:version-build.commit
NEW_IMAGE_NAME=$DOCKER_REPO:$NEW_VERSION_TAG.$SHORT_COMMIT

echo Tagging $IMAGE_NAME as $NEW_IMAGE_NAME
docker tag $IMAGE_NAME $NEW_IMAGE_NAME

echo Pushing $NEW_IMAGE_NAME
docker push $NEW_IMAGE_NAME
